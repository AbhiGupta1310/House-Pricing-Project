# House Pricing Prediction Project

This project predicts house prices in California using machine learning models. It is based on the California Housing dataset and demonstrates data preprocessing, model training, evaluation, and inference.

## Project Structure

- `housing.csv`: Main dataset containing California housing data.
- `run_pipeline.py`: Main script for training and inference using a Random Forest model.
- `evaluate_models.py`: Script for model comparison and evaluation (Linear Regression, Decision Tree, Random Forest).
- `test_data.csv`: Test set generated from the original data (used for inference).
- `predictions.csv`: Predictions generated by the trained model.
- `test_data_backup.csv`: Backup or alternative input data.

## How It Works

### 1. Data Preparation

- The dataset is loaded from `housing.csv`.
- Data is split into training and test sets using stratified sampling based on income categories.
- Features are separated into numerical and categorical columns.

### 2. Preprocessing

- Numerical features are imputed (median) and scaled.
- Categorical features are one-hot encoded.
- All preprocessing steps are combined in a pipeline using `ColumnTransformer`.

### 3. Model Training (`run_pipeline.py`)

- A Random Forest Regressor is trained on the processed data.
- The trained model and pipeline are saved as `model.pkl` and `pipeline.pkl`.

### 4. Inference (`run_pipeline.py`)

- If a trained model exists, new data from `test_data.csv` is processed and predictions are made.
- Results are saved to `predictions.csv`.

### 5. Model Comparison (`evaluate_models.py`)

- Trains and evaluates Linear Regression, Decision Tree, and Random Forest models.
- Calculates RMSE and cross-validation scores for each model.
- Prints performance metrics for comparison.

## Usage

### Training and Inference

1. Place your dataset in `housing.csv`.
2. Run `run_pipeline.py`:
   ```bash
   python run_pipeline.py
   ```
   - If no model exists, it will train and save the model.
   - If a model exists, it will perform inference on `test_data.csv` and save results to `predictions.csv`.

### Model Evaluation

- Run `evaluate_models.py` to compare different models and view their performance:
  ```bash
  python evaluate_models.py
  ```

## Requirements

- Python 3.7+
- pandas
- numpy
- scikit-learn
- joblib

Install dependencies:

```bash
pip install pandas numpy scikit-learn joblib
```

## Notes

- Ensure all CSV files are in the project root directory.
- The project uses Random Forest for final predictions, but you can experiment with other models in `evaluate_models.py`.
- The output file (`predictions.csv`) will contain predicted house prices for the input data.

## Author

Abhi Gupta

## License

This project is for educational purposes.
